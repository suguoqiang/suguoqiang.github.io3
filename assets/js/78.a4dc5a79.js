(window.webpackJsonp=window.webpackJsonp||[]).push([[78],{572:function(s,t,a){"use strict";a.r(t);var r=a(6),e=Object(r.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h4",{attrs:{id:"node-js部署之启动后台运行-forever"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#node-js部署之启动后台运行-forever"}},[s._v("#")]),s._v(" node.js部署之启动后台运行 forever")]),s._v(" "),a("h5",{attrs:{id:"安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),a("p",[s._v("可官网下载安装包上传或者选择直接在线下载，默认存放位置为tmp")]),s._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("$ cd "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr      \n$ mkdir nodejs     "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建node存放目录")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("tmp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("v8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("9"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("3"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("linux"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("x64"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("xz "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nodejs\n$ tar "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("xvf node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("v8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("9"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("3"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("linux"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("x64"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("xz       "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#解压")]),s._v("\n")])])]),a("p",[s._v("建立软连接，变为全局：")]),s._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("$ ln "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("s "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nodejs"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("v8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("9"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("3"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("linux"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("x64"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("npm "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" \n$ ln "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("s "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nodejs"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("v8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("9"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("3"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("linux"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("x64"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("node "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("local"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("\n")])])]),a("p",[s._v("查看是否安装完成：")]),s._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("$ node "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("v\n")])])]),a("h5",{attrs:{id:"安装forever全局进程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装forever全局进程"}},[s._v("#")]),s._v(" 安装forever全局进程")]),s._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("$ npm install forever "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("g\n")])])]),a("h5",{attrs:{id:"运行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#运行"}},[s._v("#")]),s._v(" 运行")]),s._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("$ forever "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("start")]),s._v(" index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("js\n")])])]),a("h5",{attrs:{id:"关闭"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#关闭"}},[s._v("#")]),s._v(" 关闭")]),s._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("$ forever stop index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("js\n")])])]),s._v(" "),a("h3",{attrs:{id:"其他"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#其他"}},[s._v("#")]),s._v(" 其他")]),s._v(" "),a("h4",{attrs:{id:"node-gyp-rebuild-的故障解决办法-即安装python-2-7环境失败"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#node-gyp-rebuild-的故障解决办法-即安装python-2-7环境失败"}},[s._v("#")]),s._v(" node-gyp rebuild 的故障解决办法，即安装python 2.7环境失败")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" uninstall node-gyp -g\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" i -g windows-build-tools\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -g node-gyp\n")])])]),a("p",[s._v("默认安装地址："),a("code",[s._v("C:\\Users\\gqsu\\.windows-build-tools\\python27")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##设置环境变量")]),s._v("\n$ setx PYTHON "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"C:\\Users\\gqsu\\.windows-build-tools\\python27\\python.exe"')]),s._v("\n")])])]),a("p",[s._v("你也可以直接添加环境变量，然后重新打开窗口安装相应依赖："),a("img",{attrs:{src:"http://cdn.gqsu.top/note01-1.png",alt:""}})]),s._v(" "),a("h3",{attrs:{id:"安装-yarn"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装-yarn"}},[s._v("#")]),s._v(" 安装 yarn")]),s._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("$ npm i yarn "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("g\n$ yarn "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("version \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 或者")]),s._v("\n$ curl "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("silent "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("location https:"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("dl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("yarnpkg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("rpm"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("yarn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("repo "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v(" sudo "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tee")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("yum"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("repos"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("d"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("yarn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("repo\n$ sudo yum install yarn "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("y\n")])])]),a("h3",{attrs:{id:"安装-pm2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装-pm2"}},[s._v("#")]),s._v(" 安装 pm2")]),s._v(" "),a("p",[s._v("pm2是一个进程管理工具,可以用它来管理你的node进程，并查看node进程的状态，当然也支持性能监控，进程守护，负载均衡等功能")]),s._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## pm2需要全局安装")]),s._v("\n$ npm install "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("g pm2\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 进入项目根目录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 启动进程/应用 ")]),s._v("\n$ pm2 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("start")]),s._v(" bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("www 或 pm2 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("start")]),s._v(" app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("js\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 重命名进程/应用 ")]),s._v("\n$ pm2 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("start")]),s._v(" app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("js "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("name wb123\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 添加进程/应用 ")]),s._v("\n$ watch pm2 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("start")]),s._v(" bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("www "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("watch\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 结束进程/应用 ")]),s._v("\n$ pm2 stop www\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 结束所有进程/应用 ")]),s._v("\n$ pm2 stop all\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 删除进程/应用 ")]),s._v("\n$ pm2 delete www\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 删除所有进程/应用 ")]),s._v("\n$ pm2 delete all\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 列出所有进程/应用 ")]),s._v("\n$ pm2 list\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 查看某个进程/应用具体情况 ")]),s._v("\n$ pm2 describe www\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 查看进程/应用的资源消耗情况 ")]),s._v("\n$ pm2 monit\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 查看pm2的日志 ")]),s._v("\n$ pm2 logs\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 若要查看某个进程/应用的日志,使用 ")]),s._v("\n$ pm2 logs www\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 重新启动进程/应用 ")]),s._v("\n$ pm2 restart www\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 重新启动所有进程/应用 ")]),s._v("\n$ pm2 restart all\n")])])])])}),[],!1,null,null,null);t.default=e.exports}}]);